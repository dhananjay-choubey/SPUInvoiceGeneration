<mvc:View xmlns:mvc="sap.ui.core.mvc" xmlns="sap.m" xmlns:fb="sap.ui.comp.filterbar" xmlns:core="sap.ui.core" xmlns:tnt="sap.tnt"
	xmlns:f="sap.f" xmlns:smartTable="sap.ui.comp.smarttable" controllerName="com.ifb.invoicegenerator.controller.InvoiceManagement" displayBlock="true"
	height="{='calc(100% - 3rem)' }">
	<tnt:ToolHeader visible="true">
		<Button  icon="sap-icon://nav-back" press=".onNavBack" class="sapUismallMarginEnd" />
		<Title text="Invoice Management" class="sapUiSmallMarginBegin" />
		<ToolbarSpacer/>
		<core:Fragment
                fragmentName='com.ifb.invoicegenerator.fragments.Menu'
                type='XML'
        />
	</tnt:ToolHeader>
	<f:DynamicPage id="dynamicPageId" headerExpanded="true" showFooter="true"
	class="sapUiContentPadding sapUiResponsivePadding--header sapUiResponsivePadding--subHeader sapUiResponsivePadding--content sapUiResponsivePadding--footer" >
		<f:header>
			<f:DynamicPageHeader pinnable="true">
				<f:content>
					<fb:FilterBar id="filterbar" clear="onClear" reset="onReset" search="onSearch" useToolbar="false" showRestoreButton="true" showFilterConfiguration="false"
						showClearButton="true" showClearOnFB="true" filterBarExpanded="true">
						<fb:filterGroupItems>
							<fb:FilterGroupItem name="invoiceDateRangeLabel" label="Invoice Date" groupName="__$INTERNAL$" visibleInFilterBar="true">
								<fb:control>
									<DateRangeSelection id="invoiceDateRange" change="handleChange"/>
								</fb:control>
							</fb:FilterGroupItem>
							<fb:FilterGroupItem name="invoiceFreeSearchLabel" label="Invoice Number" groupName="__$INTERNAL$" visibleInFilterBar="true">
								<fb:control>
									<Input id="invoiceFreeSearch" placeholder="Invoice Number" submit="onSearch"></Input>
								</fb:control>
							</fb:FilterGroupItem>
							<fb:FilterGroupItem name="invoiceFreeSearchTicketLabel" label="Ticket Number" groupName="__$INTERNAL$" visibleInFilterBar="true">
								<fb:control>
									<Input id="invoiceFreeTicketSearch" placeholder="Ticket Number" submit="onSearch"></Input>
								</fb:control>
							</fb:FilterGroupItem>
							<fb:FilterGroupItem name="invoiceFreeSearchRefLabel" label="Reference Number" groupName="__$INTERNAL$" visibleInFilterBar="true">
								<fb:control>
									<Input id="invoiceFreeRefSearch" placeholder="Reference Number" submit="onSearch"></Input>
								</fb:control>
							</fb:FilterGroupItem>
							<fb:FilterGroupItem name="gmPartyLabel" label="Party Name" groupName="__$INTERNAL$" visibleInFilterBar="true">
								<fb:control>
									<Select id="invoiceParty" forceSelection="false" change="onSearch" items="{ path: 'VendorListModel>/' }">
										<core:Item key="{VendorListModel>vendorcode}" text="{VendorListModel>vendorname}"/>
									</Select>
								</fb:control>
							</fb:FilterGroupItem>
						</fb:filterGroupItems>
					</fb:FilterBar>
				</f:content>
			</f:DynamicPageHeader>
		</f:header>
		<f:content>
			<smartTable:SmartTable id="invoiceTable" entitySet="Invoices" enableAutoBinding="false" beforeRebindTable="onBeforeRebindTable"
				tableType="ResponsiveTable" showRowCount="true" header="Invoices" showFullScreenButton="true" showTablePersonalisation="false"
				initiallyVisibleFields="InvoiceNumber,InvoiceDate,SPUNumber,CRMTicketNumber,DocumentNumber,DocumentDate,VendorName,VendorCode,CustomerName,CustomerCode,ShipToPartyNumber,ShipToPartyName,SubTotal,SGST,CGST,IGST,RoundOff,GrandTotal,branchgstin,shiptopartyaddress"
				class="sapUiResponsiveContentPadding sapUiLargeMarginBottom" placeToolbarInTable="true">
				<smartTable:customData>
					<core:CustomData key="p13nDialogSettings"
						value='\{ "filter": \{ "visible": true},"sort": \{ "visible": true}, "group": \{ "visible": false} }'/>
				</smartTable:customData>
				<smartTable:customToolbar>
					<OverflowToolbar design="Transparent">
						<content>
							<ToolbarSpacer/>
							<Button text="Bulk Print" icon="sap-icon://print" press="onBulkPrintPress" />
							<Button text="Digital Signature" icon="sap-icon://signature" press="onDigitalSignature" 
								type="Accept" visible="{= (${LoginDataModel>/usertype} === 'V') ? true : false }"/>
							    <!-- <MenuButton text="Action">
									<menu>
										<Menu>
											 <MenuItem
												text="Download"
												icon="sap-icon://download"
												press="onBulkDownloadPress"
											/>
											<MenuItem
												text="Bulk Print"
												icon="sap-icon://print"
												press="onBulkPrintPress"
											/>
										</Menu>
									</menu>
								</MenuButton> -->
							<OverflowToolbarButton icon="sap-icon://sort" tooltip="{i18n>sort}" text="{i18n>sort}" press="onSort"/>
						</content>
					</OverflowToolbar>
				</smartTable:customToolbar>
				<Table mode="MultiSelect" sticky="HeaderToolbar,ColumnHeaders" growing="true" growingThreshold="100" width="100%" updateFinished="onTableUpdateFinished">
					<columns>
						<Column>
							<customData>
								<core:CustomData key="p13nData"
									value='\{"sortProperty": "InvoiceNumber", "type": "string","columnKey": "InvoiceNumber", "leadingProperty": "InvoiceNumber"}'/>
							</customData>
							<Text text="Invoice Number"/>
						</Column>
						<Column  minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline">
							<customData>
								<core:CustomData key="p13nData"
									value='\{"sortProperty": "InvoiceDate", "type": "string", "leadingProperty": "InvoiceDate","columnKey": "InvoiceDate"}'/>
							</customData>
							<Text text="Invoice Date"/>
						</Column>
						<Column minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline">
							<customData>
								<core:CustomData key="p13nData" value='\{"sortProperty": "SPUNumber", "type": "string","columnKey": "SPUNumber", "leadingProperty": "SPUNumber"}'/>
							</customData>
							<Text text="SPU No"/>
						</Column>
						<Column minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline">
							<customData>
								<core:CustomData key="p13nData"
									value='\{"sortProperty": "CRMTicketNumber", "type": "string","columnKey": "CRMTicketNumber", "leadingProperty": "CRMTicketNumber"}'/>
							</customData>
							<Text text="Ticket No"/>
						</Column>
						<Column minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline">
							<customData>
								<core:CustomData key="p13nData"
									value='\{"sortProperty": "DocumentNumber", "type": "string","columnKey": "DocumentNumber", "leadingProperty": "DocumentNumber"}'/>
							</customData>
							<Text text="Ref Number"/>
						</Column>
						<Column  minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline">
							<customData>
								<core:CustomData key="p13nData"
									value='\{"sortProperty": "DocumentDate", "type": "string","columnKey": "DocumentDate", "leadingProperty": "DocumentDate"}'/>
							</customData>
							<Text text="Ref Date"/>
						</Column>
						<Column minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline">
							<customData>
								<core:CustomData key="p13nData"
									value='\{"sortProperty": "CustomerName", "type": "string","columnKey": "CustomerName", "leadingProperty": "CustomerName"}'/>
							</customData>
							<Text text="Organization"/>
						</Column>
						<Column minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline">
							<customData>
								<core:CustomData key="p13nData"
									value='\{"sortProperty": "VendorName", "type": "string", "columnKey": "VendorName", "leadingProperty": "VendorName"}'/>
							</customData>
							<Text text="Party Name"/>
						</Column>
						<Column minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline">
							<customData>
								<core:CustomData key="p13nData"
									value='\{"sortProperty": "ShipToPartyName", "type": "string", "columnKey": "ShipToPartyName", "leadingProperty": "ShipToPartyName"}'/>
							</customData>
							<Text text="Consignee"/>
						</Column>
						<Column minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline" hAlign="End">
							<customData>
								<core:CustomData key="p13nData"
									value='\{"sortProperty": "SubTotal", "type": "string","columnKey": "SubTotal", "leadingProperty": "SubTotal"}'/>
							</customData>
							<Text text="Sub Total"/>
						</Column>
						<Column minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline" hAlign="End">
							<customData>
								<core:CustomData key="p13nData"
									value='\{"sortProperty": "SGST", "type": "string", "columnKey": "SGST", "leadingProperty": "SGST"}'/>
							</customData>
							<Text text="SGST"/>
						</Column>
						<Column minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline" hAlign="End">
							<customData>
								<core:CustomData key="p13nData"
									value='\{"sortProperty": "CGST", "type": "string", "columnKey": "CGST", "leadingProperty": "CGST"}'/>
							</customData>
							<Text text="CGST"/>
						</Column>
						<Column minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline" hAlign="End">
							<customData>
								<core:CustomData key="p13nData"
									value='\{"sortProperty": "IGST", "type": "string", "columnKey": "IGST", "leadingProperty": "IGST"}'/>
							</customData>
							<Text text="IGST"/>
						</Column>
						<Column minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline" hAlign="End">
							<customData>
								<core:CustomData key="p13nData"
									value='\{"sortProperty": "RoundOff", "type": "string", "columnKey": "RoundOff", "leadingProperty": "RoundOff"}'/>
							</customData>
							<Text text="RoundOff"/>
						</Column>
						<Column minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline" hAlign="End">
							<customData>
								<core:CustomData key="p13nData"
									value='\{"sortProperty": "GrandTotal", "type": "string", "columnKey": "GrandTotal", "leadingProperty": "GrandTotal"}'/>
							</customData>
							<Text text="Grand Total"/>
						</Column>
						<Column minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline" hAlign="Begin">
							<customData>
								<core:CustomData key="p13nData"
									value='\{"sortProperty": "branchgstin", "type": "string", "columnKey": "branchgstin", "leadingProperty": "branchgstin"}'/>
							</customData>
							<Text text="IFB GSTIN"/>
						</Column>
						<Column minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline" hAlign="Begin">
							<customData>
								<core:CustomData key="p13nData"
									value='\{"sortProperty": "shiptopartyaddress", "type": "string", "columnKey": "shiptopartyaddress", "leadingProperty": "shiptopartyaddress"}'/>
							</customData>
							<Text text="Consignee Address"/>
						</Column>
						<Column  id="invoiceActionColumn" minScreenWidth="Tablet" demandPopin="true" popinDisplay="Inline">
							<customData>
								<core:CustomData id="invoiceCustomDataActionCol" key="p13nData" value='\{"columnKey": "Action"}'/>
							</customData>
							<Text text="Action"/>
						</Column>
					</columns>
					<items>
						<ColumnListItem type="Inactive">
							<ObjectIdentifier title="{InvoiceNumber}"/>
							<ObjectIdentifier title="{path : 'InvoiceDate', type:'sap.ui.model.type.Date', 
							formatOptions:{source : { pattern: 'yyyyMMdd'},
							style: 'long'
							}}"/>
							<Text text="{SPUNumber}"/>
							<Text text="{CRMTicketNumber}"/>
							<Text text="{DocumentNumber}"/>
							<Text text="{path : 'DocumentDate', type:'sap.ui.model.type.Date', 
							formatOptions:{source : { pattern: 'yyyyMMdd'},
							style: 'long'
							}}"/>
							<Text text="{CustomerName}"/>
							<Text text="{VendorName}"/>
							<Text text="{ShipToPartyName}"/>
							<Text text="{SubTotal}" textAlign="End"/>
							<Text text="{SGST}" textAlign="End"/>
							<Text text="{CGST}" textAlign="End"/>
							<Text text="{IGST}" textAlign="End"/>
							<Text text="{RoundOff}" textAlign="End"/>
							<Text text="{GrandTotal}"  textAlign="End"/>
							<Text text="{branchgstin}"/>
							<Text text="{shiptopartyaddress}"/>
							<HBox>
								<Button tooltip="View" type="{=${InvoicePdfStatus} === 'X' ? 'Accept' : 'Reject'}" enabled="{=${InvoicePdfStatus} === 'X' ? true : false}" icon="sap-icon://display" press="onPrintPreviewPress" class="sapUiTinyMarginEnd"/>
								<Button tooltip="Print" type="{=${InvoicePdfStatus} === 'X' ? 'Accept' : 'Reject'}" enabled="{=${InvoicePdfStatus} === 'X' ? true : false}" icon="sap-icon://print" press="onPrintPress"/>
							</HBox>
							
						</ColumnListItem>
					</items>
				</Table>
			</smartTable:SmartTable>
		</f:content>
	</f:DynamicPage>
</mvc:View>